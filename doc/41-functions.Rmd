```{r funcs}
area_plot_posts <- function (data, cut_start, cut_end) {
  area_chart(data) +
    labs(x = "", y = "Anteil Kommentare") +
    scale_fill_manual(
      "Topic",
      breaks = topics_present,
      values = cols,
      guide = guide_legend(
        direction = "horizontal",
        title.position = "top",
        label.position = "bottom",
        nrow = 1
      )
    ) +
    geom_vline(aes(xintercept = as.Date(cut_start)),
               linetype = "dotted") +
    geom_vline(aes(xintercept = as.Date(cut_end)),
               linetype = "dotted") +
    ggplot2::annotate(
      "rect",
      xmin = as.Date(cut_start),
      xmax = as.Date(cut_end),
      ymin = 0,
      ymax = Inf,
      fill = "lightgrey",
      alpha = .5
    ) +
    theme(legend.position = "bottom")
}

area_plot_alters <- function (data, cut_start, cut_end) {
area_chart(alters_proportions_full) +
  labs(x = "", y = "Anteil Alteri") +
  scale_fill_manual(
    "Topic",
    breaks = topics_present,
    values = cols,
    guide = guide_legend(
      direction = "horizontal",
      title.position = "top",
      label.position = "bottom",
      nrow = 1
    )
  ) +
  geom_vline(aes(xintercept = as.Date(cut_start)),
             linetype = "dotted") +
  geom_vline(aes(xintercept = as.Date(cut_end)),
             linetype = "dotted") +
  ggplot2::annotate(
    "rect",
    xmin = as.Date(cut_start),
    xmax = as.Date(cut_end),
    ymin = 0,
    ymax = Inf,
    fill = "lightgrey",
    alpha = .5
  ) +
  theme(legend.position = "bottom")
}
```

