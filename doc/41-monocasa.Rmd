### monocasa
Der User mit dem Nutzernamen "monocasa" ist im betrachteten Ausschnitt aus dem Datensatz in 119 Monaten enthalten und hat insgesamt 7996 Kommentare erstellt, was im Mittel `r fmt(round(7996 / 119, 2))` Kommentaren pro Monat entspricht.

```{r monocasa-setup, cache=FALSE}
user <- "monocasa"
date_range_full_start <- "2007-01-01"
date_range_full_end <- "2018-02-01"
date_range_cut_start <- "2011-10-01"
date_range_cut_end <- "2015-10-01"

date_range_full <-
    seq.Date(as.Date(date_range_full_start),
             as.Date(date_range_full_end),
             by = "1 month")

date_range <-
  seq.Date(from = as.Date(date_range_cut_start),
           to = as.Date(date_range_cut_end),
           by = "1 month")

ego_topics_full <-
  read_ego_topics(user = user, date = date_range_full)
alters_topics_full <-
  read_alters_topics(user = user, date = date_range_full)

ego_proportions_full <- post_proportions(ego_topics_full)
alters_proportions_full <- user_proportions(alters_topics_full)


ego_topics <- read_ego_topics(user = user, date = date_range)
ego_proportions <- post_proportions(ego_topics)

alters_topics <- read_alters_topics(user = user, date = date_range)
alters_proportions <- user_proportions(alters_topics)

topics_present <-
  union(ego_proportions_full$topic, alters_proportions_full$topic)
cols <- fill_colours(topics_present)

edgelists <-
  read_edgelist(user, date = date_range) %>%
  select(-year, -month, edgelist = data)

topics_of_alters <-
  read_alters_topics(user, date = date_range) %>%
  select(-year, -month, topics = data)
```

#### Topic-Verteilungen

Um einen Überblick zu erhalten, in welchen Topics der Nutzer aktiv ist, bietet es sich an, die Verteilung der Kommentare zu visualisieren.
Alle Kommentare werden über das Subreddit, in dem sie erstellt wurden, einem Topic zugeordnet.
In Abbildung \@ref(fig:monocasa-topic-distribution) ist zu erkennen, dass der Nutzer hauptsächlich in drei Topics aktiv ist: 210, 239 und 235.
Auch der zeitliche Verlauf der Topics in Abbildung \@ref(fig:monocasa-area-chart-comms-full) lässt dies erkennen.
Wie bereits weiter oben festgestellt, handelt es sich bei Topic 239 um technisch orientierte Inhalte, bei 210 um Politik mit Schwerpunkt auf US-amerikanischen Themen.
Die weitere Analyse wird sich vor allem auf diese großen Topics stützen, da sie zum einen trennscharf abgegegrenzt werden können, und zudem die meiste Aktivität des Nutzers auf sich vereinen.

(ref:monocasa-topic-distribution) Verteilung von Kommentaren über Topics.
```{r monocasa-topic-distribution, fig.cap="monocasa-topic-distribution",cache=FALSE}
comment_dist_boxplot(ego_proportions_full)
```

Bei der Analyse des Topic-Verlaufs fällt auf, dass der Anteil von Topic 239 zwichen 2013 und 2014 zweimal stark abfällt: einmal im Juli 2013 und kurz darauf im Oktober 2013.
Der Abfall auf einen Anteil von 0 eines Topics wird im weiteren Verlauf gleichgesetzt mit einem Verlassen dieser thematischen Community durch den Nutzer.
Im Folgenden wird der Frage nachgegangen, was für dieses Verlassen ursächlich sein könnte.
Dazu werden verschiedene Eigenschaften der Topicverläufe sowie der lokalen Egonetzwerke des Nutzers herangezogen.
Der Untersuchungszeitraum wird auf die Zeit zwei Jahre vor und zwei Jahre nach dem Verlassen im Oktober 2013 festgelegt; dies ist durch die beiden gepunkteten Linien sowie die grau hinterlegte Fläche in Abb.\ \@ref(fig:monocasa-topic-distribution) angedeutet.

Auch für die Alteri lässt sich ein ähnlicher Topic-Verlauf bestimmen, indem pro Monat für jeden von ihnen das Topic bestimmt wird, wo er die meisten Kommentare verfasst; so wird jeder dieser Nutzer auf ein einzelnes Topic festgelegt, das ihn charakterisiert.
Damit lässt sich bestimmen, welchen Anteil ein Topic unter den Alteri ausmacht.
Auch Abbildung \@ref(fig:monocasa-area-chart-alters-full) lässt erkennen, dass in dem gewählten Zeitraum der Anteil der Alteri, die sich ebenfalls an diesem Topic beteiligen, auf 0 abfällt.
Zudem fällt auf, dass sich Ego und Alteri durchaus in ihren Interessen überschneiden; in `r pronounce(length(intersect(ego_proportions_full$topic, alters_proportions_full$topic)))` Topics erstellen sowohl Ego als auch Alteri Kommentare.

(ref:monocasa-area-chart-comms-full) Topic-Verteilung von Egos Kommentaren. Dargestellt sind die relativen Anteile eines Topics an allen Kommentaren, die Ego in einem gegebenen Monat erstellt.
```{r monocasa-area-chart-comms-full, fig.cap="(ref:monocasa-area-chart-comms-full)"}
area_plot_posts(ego_proportions_full, date_range_cut_start, date_range_cut_end)
```
(ref:monocasa-area-chart-alters-full) Topic-Verteilung der Alteri im lokalen Netzwerk. Dargestellt sind die relativen Anteile eines Topics an allen Kommentaren, die Ego in einem gegebenen Monat erstellt.
```{r monocasa-area-chart-alters-full, fig.cap="(ref:monocasa-area-chart-alters-full)"}
area_plot_alters(alters_proportions_full, date_range_cut_start, date_range_cut_end)
```

\todo{ZoomPlots in den Analysezeitraum wurden gestrichen. Passt?}
```{r monocasa-area-chart-comms-zoom, include=FALSE}
area_chart(ego_proportions) +
  scale_fill_manual(
    "Topic",
    breaks = topics_present,
    values = cols,
    guide = guide_legend(
      direction = "horizontal",
      title.position = "top",
      label.position = "bottom",
      nrow = 1
    )
  ) +
  labs(title = "Topic-Zugehörigkeit der Posts von Ego") +
  theme(legend.position = "bottom")
  
```

```{r monocasa-area-chart-alters-zoom,include=FALSE}
area_chart(alters_proportions) +
  scale_fill_manual(
    "Topic",
    breaks = topics_present,
    values = cols,
    guide = guide_legend(
      direction = "horizontal",
      title.position = "top",
      label.position = "bottom",
      nrow = 1
    )
  ) +
  labs(title = "Topic-Zugehörigkeit der Alteri") +
  theme(legend.position = "bottom")
```

\todo{Passt es, hier keine Legende zu zeigen?}
(ref:monocasa-num-posts) Kommentare pro Monat pro Topic. Die gepunktete Linie zeigt das Datum des "Verlassens" von Topic 239.
```{r monocasa-num-posts, fig.cap="(ref:monocasa-num-posts)", include=FALSE}
num_posts_facet(ego_proportions) + geom_vline(aes(xintercept = as.Date("2013-10-01")),
             linetype = "dotted")
```

#### Zusammenhang zwischen Ego und Alteri

Zunächst soll betrachtet werden, wie das Kommentar-Verhalten von Ego mit der Zusammensetzung seiner Alteri zusammenhängt.
Die Vermutung dabei ist, dass ein höherer Anteil Alteri eines Topics dazu führt, dass auch Ego vermehrt in diesem Topic aktiv ist, bzw. Ego, basierend auf seinen Interessen, sein Umfeld auswählt.

(ref:monocasa-prob-corr) Die beiden Anteile an Topic-Zugehörigkeit, gegeneinander aufgetragen. Entlang der x-Achse ist der relative Anteil an Kommentaren angetragen, die Ego in einem Topic verfasst hat; entlang der y-Achse ist der relative Anteil Alteri angetragen, der einem Topic zugeordnet wurde. Die blaue Linie fittet ein lineares Modell auf den Daten.
```{r monocasa-prob-corr, fig.cap = "(ref:monocasa-prob-corr)"}
left_join(ego_proportions_full, alters_proportions_full, by = c("date", "topic")) %>%
  rename(prop_ego = prop.x, prop_alters = prop.y) %>%
  filter(date >= date_range_cut_start & date <= date_range_cut_end) %>% 
  ggplot(mapping = aes(x = prop_ego, y = prop_alters, colour = topic)) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", size = .8) +
  geom_abline(size = .1) +
  labs(
    x = "Anteil Kommentare",
    y = "Anteil Alteri"
  ) +
  scale_colour_manual("topic",
                      values = cols) +
  facet_wrap(~ topic) +
  theme(
    axis.text.x = element_text(angle = 0),
    legend.position = "none"
  )
```

Wie vermutet lassen sich vor allem bei den großen Topics, in denen der Nutzer vermehrt Aktivität verzeichnet, lineare Zusammenhänge erkennen.
Auffällig dabei ist, dass die beiden Topics 210 und 239 sublinear wachsen, ihre Regressionsgerade also unterhalb der Diagonal verläuft.
Der Nutzer ist also verstärkt in diesen Topics aktiv, obwohl sein Umfeld nicht "mitzieht".

#### Anziehungskraft von Topics

Was macht ein Topic attraktiv für einen Nutzer?
Zum Einen sollte es ihn selbst interessieren, zum anderen sollte aber auch sein Umfeld dieses Thema kennen und sich ihm widmen.
Fasst man die erhobenen Topic-Verteilungen von Ego und Alteri als Wahrscheinlichkeiten auf, dass Ego einen Kommentar in einem Topic abgibt resp. dass einer der Alteri in diesem Topic aktiv ist, kann man auch Attraktivität als Wahrscheinlichkeit definieren, dass ein Nutzer in einem Topic verbleibt.
Diese ist umso höher, je höher die beiden anderen Wahrscheinlichkeiten sind, wshalb im Folgenden Attraktivität als gemeinsame Wahrscheinlichkeit der Ereignisse $E = \{\text{Ego erstellt Kommentar in Topic}\}$ und $A = \{\text{Alter ist in Topic aktiv}\}$ aufgefasst wird:

\begin{equation}
P(E \cap A) = P(E)P(A)
(\#eq:attractive)
\end{equation}

(ref:monocasa-interestingness) Attraktitivtät angetragen über den zeitlichen Verlauf. Die gepunktete Linie kennzeichnet den Zeitpunkt des Verlassens von Topic 239. In dieser Darstellung enthalten sind alle TOpics, deren Attraktivität in Summer echt größer 0 ist.
```{r monocasa-interestingness, fig.cpa="(ref:monocasa-interestingness)"}
attractivity(ego_proportions_full, alters_proportions_full, date_range_cut_end, date_range_cut_start)+
  geom_vline(aes(xintercept = as.Date("2013-10-01")),
             linetype = "dotted")
```

$P(E \cap A)$ wird nachfolgend auch als *Attraktivität* wiedergegeben.
Abbildung \@ref(fig:monocasa-interestingness) zeigt die zeitliche Entwicklung dieser Messgröße.
Es sind einige Spitzen zu erkennen, die auf sehr hohe, aber zeitlich begrenzte Attraktivität hindeuten.
Der Zeitpunkt des Austritts aus 239 liegt inmitten einer Phase niedriger Attraktivität dieses Topics.

Um die spitzen Ausschläge besser verstehen zu können, bietet es sich an, die Gesamtzahl aller Kommentare zu betrachten.
Ist der Nutzer allgemein zu einem beliebigen Zeitpunkt eher weniger aktiv und erstellt einen einzelnen Kommentar, wird dieser einen solchen Ausschlag herbeiführen.
Abbildung\ \@ref(fig:monocasa-total-posts)

(ref:monocasa-total-posts)
```{r monocasa-total-posts, fig.cap="(ref:monocasa-total-posts)"}
ego_proportions %>%
  group_by(date) %>%
  mutate(sum = sum(num_posts)) %>%
  group_by(topic) %>%
  filter(sum(num_posts) > 1) %>%
  ggplot(mapping = aes(x = date, y = num_posts, colour = topic)) +
  # geom_point(alpha = .5) +
  geom_line(
    mapping = aes(y = sum),
    colour = "red",
    size = .3,
    linetype = "dashed"
  ) +
  
  labs(
    x = "Jahr", 
    y = "# Posts", 
    legend = "Foo"
  ) +
  scale_x_date(date_breaks = "1 year", date_labels = "%Y", date_minor_breaks = "1 month") +
  geom_vline(mapping = aes(xintercept = as.Date("2013-10-01")),
             linetype = "dotted") +
  
```

---------

Die vertikale gepunktete Linie markiert den Zeitpunkt des Austritts im Oktober 2013; die rote gestrichelte Linie stellt die
aggregierte Zahl der Posts für einen Monat dar. Auch diese Kurve fällt im Oktober stark ab, der User erstellt kaum Kommentare.


-----

**TODO: KLÄREN OB MAN DAS WEITER VERFOLGT, GGF BESSER MIT VOLLSTÄNDIGEM ZEITRAUM ??**

Dies wirft die Frage auf, auf welchen Zeitraum diese "markanten" Verhältnisse entfallen. Hierzu unterteilen wir den
Analysezeitraum nochmals in drei Abschnitte ("früh", "mittel", "spät") und ordnen jeden Datenpunkt einem dieser Abschnitte
zu. 

Im Juli 2013 sinkt die Wahrscheinlichkeit eines Ego-Posts in Topic 239 auf `r round(subset(ego_proportions, date == "2013-07-01" & topic == 239, prop)$prop, 2)`. Im Oktober 2013 verlässt der User Topic 239 gänzlich, $p_e$ sinkt auf `r round(subset(ego_proportions, date == "2013-10-01" & topic == 239, prop)$prop, 2)`. Die Wahrscheinlichkeit steigt danach wieder, bis sie im Januar 2015 den zweithöchsten Wert in diesem Zeitraum erreicht von `r round(subset(ego_proportions, date == "2015-01-01" & topic == 239, prop)$prop, 2)`.

#### Analyse des Netzwerks

```{r monocasa-egonets}

# identify the single top topic of ego for a month in the dataset
ego_top_topics <-
  ego_proportions %>%
  group_by(date) %>%
  summarize(user = user,
            topic = topic[which.max(prop)]) %>%
  select(date, user = user, topic)

vertex_data <-
  topics_of_alters %>%
  unnest() %>%
  select(date, user = author1, topic) %>%
  rbind(ego_top_topics) %>%
  group_by(date) %>%
  nest() %>%
  rename(topics = data)

graph_data <-
  left_join(edgelists, vertex_data, by = "date") %>%
  mutate(graph = map2(edgelist, topics, egonet_from_edgelist)) %>%
  select(date, graph)
```

#### Knoten und Kanten im Graphen

Um eine Übersicht über die Struktur des sozialen Netzes des Nutzers zu erhalten, betrachten wir die Entwicklung 
der Größe dieses Netzes.

```{r monocasa-network-structure}
graph_data %>%
  ggplot(mapping = aes(x = date, y = count, colour = variable)) +
  geom_line(mapping = aes(y = vvcount(graph), colour = "vertices")) +
  geom_line(mapping = aes(y = vecount(graph), colour = "edges")) +
  ylab("count") +
  scale_x_date(
    date_breaks = "1 year",
    date_minor_breaks = "3 month",
    date_labels = "%Y"
  ) +
  scale_y_continuous(breaks = seq(0, 200, 10),
                     minor_breaks = seq(0, 200, 5)) +
  theme(
    axis.text.x = element_text(angle = 90), legend.position = "bottom"
  ) + 
  labs(
    x = "Zeit",
    y = "Anzahl"
  ) +
  scale_colour_discrete(name = "Variable", labels = c("edges" = "Kanten", "vertices" = "Knoten"))
```

Im Oktober 2013 besteht das Ego-Netz des Nutzers aus `r vcount(subset(graph_data, date == as.Date("2013-10-01"))$graph[[1]])` Knoten, es finden also Interaktionen mit 4 weiteren Nutzern statt; im Graphen gibt es `r ecount(subset(graph_data, date == as.Date("2013-10-01"))$graph[[1]])` Kanten, also zu jedem Nutzer eine.

Das soziale Netz ist als Multigraph modelliert, ein Post entspricht einer Kante. Die Visualisierung zeigt, dass im Oktober 2013 auch die Anzahl an Posts des Users auf ein Minimum fällt. Um mögliche Ursachen hierfür zu erforschen, betrachten wir die Reziprozität der Interaktionen.

#### Reziprozität

Wir bestimmen zuerst die Reziprozität im gesamten Graphen.

```{r monocasa-katz-powell}

graph_data %>%
  mutate(
    katz_powell = katz_powell_mutuality(graph),
    ratio_reciprocity = map_dbl(graph, reciprocity, mode = "ratio"),
    centered_reciprocity = map_dbl(graph, degree_ratio)
  ) %>%
  ggplot(mapping = aes(x = date, y = value, colour = measure)) +
  geom_line(mapping = aes(y = katz_powell, colour = "kp")) +
  geom_line(mapping = aes(y = centered_reciprocity, colour = "inout")) +
  geom_smooth(mapping = aes(y = katz_powell, colour = "kp")) +
  geom_smooth(mapping = aes(y = centered_reciprocity, colour = "inout")) +
  scale_y_continuous(limits = c(0, NA) ) +
  scale_x_date(
    date_breaks = "1 year",
    date_minor_breaks = "3 month",
    date_labels = "%Y"
  ) +
  theme(
    axis.text.x = element_text(angle = 90), legend.position = "bottom"
  ) +
  labs(x = "Zeit", y = "Wert") +
  scale_color_discrete(name = "Maß", labels = c("kp" = "Katz-Powell-Index", "inout" = expression(frac("d"^"+", "d"^"-"))))
```
Es bietet sich ein ähnliches Bild wie zuvor: der Katz-Powell Index schwankt zwischen ca. 0.35 und 0.55, und fällt im Oktober 2013 stark ab; der Index nimmt sogar einen negativen Wert an, was bedeutet, dass zu wenig Beobachtungen (Knoten) vorliegen, um eine fundierte Aussage treffen zu können.
Dass das Verhältnis eingehender zu ausgehender Kanten teilweise Werte $>= 1$ annimmt, zeigt, dass in diesen Monaten die Zahl der eingehenden Kanten die der ausgehenden übertrifft. Im Mittel bleibt das Verhältnis unter 1, es gibt also mehr ausgehende Kanten von Ego zu den Alteri.

Der gesamte Snapshot-Graph $G$ des Nutzers umfasst alle Interaktionen, die in einem Monat stattfinden. Kanten manifestieren
sich von Ego zu Alteri wenn der eine auf einen Kommentar des anderen reagiert. Dabei bestimmen wir sowohl für Ego als auch 
die Alteri das Topic, wo sie in dem Monat die meisten Interatkionen verzeichnen. Für Ego kennen wir zudem die Top 5 Topics
eines Monats. Stellen wir uns das Attribut "Topic" als Farbe des Knotens vor, hat jeder der Alteri eine Färbung, und Ego
ist ähnlich einem Tortendiagramm in fünf Farben gegliedert. Dabei ist es keineswegs eine Voraussetzung, dass Ego und Alteri
Farben teilen! Kanten können durchaus auch zu anderen Usern bestehen, die einen anderen thematischen Schwerpunkt aufweisen.

Die Knoten, die (mindestens) eine Farbe mit dem zentralen Ego-Knoten gemeinsam haben, formen einen Teilgraph $G'$, den wir als "thematisch ähnlich" bezeichnen. Wir stellen den Grad der beiden Graphen $G$ und $G'$, sowie deren Größenunterschied $V(G) - V(G')$ im zeitlichen Verlauf dar.

```{r monocasa-topical-subgraph}
# TODO: Filter topical subgraphs, then compute weighted degree

graph_topical_subgraph <-
  graph_data %>%
  left_join(ego_topics, by = c("date")) %>%
  mutate(topical_subgraph = map2(graph, data, function(graph, df) {
    filter_graph(graph, unique(df$topic))
  }))

graph_topical_subgraph %>%
  mutate(size_diff = vvcount(graph) - vvcount(topical_subgraph)) %>%
  select(date, graph, topical_subgraph, size_diff) %>%
  ggplot(mapping = aes(x = date, y = nodes, colour = graph)) +
  geom_line(mapping = aes(y = vvcount(graph), colour = "G")) +
  geom_line(mapping = aes(y = vvcount(topical_subgraph), colour = "G'")) +
  geom_line(mapping = aes(y = size_diff, colour = "G - G'")) +
  geom_smooth(mapping = aes(y = size_diff, colour = "G - G'")) +
  scale_x_date(
    date_breaks = "1 year",
    date_minor_breaks = "3 month",
    date_labels = "%Y"
  ) +
  theme(
    axis.text.x = element_text(angle = 90), legend.position = "bottom"
  )
```

Der Größenunterschied steigt im Zeitraum tendenziell an, wobei ein "auf und ab"-Muster erkennbar ist; zum Ende des 
analysierten Zeitraums ist die Tendenz dann wieder eher fallend. Der User interagiert also durchaus vermehrt mit
anderen, die sein thematisches Interesse nicht zwingend teilen.

---------

**TODO**: Für gesamten Zeitraum ebenfalls darstellen

----------

Um einen Grund für das Verlassen des Topics, wie auch offenbar der Plattform generell zu finden, bietet sich eine genauere
Untersuchung der sozialen Netzwerkgraphen an.

Für einen Monat im Untersuchungszeitraum kennen wir für Ego die Verteilung der fünf häufigsten Topics. Ebenso wissen wir
für jeden der Alteri, in welchem Topic er oder sie am aktivsten waren. Aus diesen Beobachtungen können wir erneut einen
Teilgraphen konstruieren, der je Ego-Topic nur diejenigen Alteri enthält, die ebenfalls in diesem Topic aktiv waren.
Für diesen Teilgraphen berechnen wir erneut Reziprozitätsmaße.

Im Folgenden betrachten wir einige Maße, die diese Graphen charakterisieren.

```{r monocasa-single-topic-subgraph}

graph_single_topic_subgraph <-
  ego_proportions %>%
  rename("prop_ego" = prop) %>% 
  left_join(graph_data, by = "date") %>%
  left_join(alters_proportions, by = c("date", "topic")) %>% 
  rename("prop_alters" = prop) %>% 
  mutate(
    topic_graph = map2(graph, topic, filter_graph_wrapper)
    )
```

```{r monocasa-subgraph-per-topic}
graph_single_topic_subgraph %>% 
  mutate(
    vs = vvcount(topic_graph) - 1,
    es = vecount(topic_graph)
  ) %>% 
  ggplot(mapping = aes(x = date, y = value, colour = variable)) +
  geom_line(mapping = aes(y = vs, colour = "vertices")) +
  geom_line(mapping = aes(y = es, colour = "edges")) +
  scale_x_date(
    date_breaks = "1 year",
    date_minor_breaks = "3 month",
    date_labels = "%Y"
  ) +
  theme(
    axis.text.x = element_text(angle = 90)
  ) +
  labs(
    x = "Zeit",
    y = "Anzahl"
  ) +
  scale_color_discrete(name = "Variable", labels = c("vertices" = "Knoten", "edges" = "Kanten")) +
  facet_wrap(~topic)
```

--------

**TODO:** Topic finden und filtern

--------

```{r monocasa-dungraph-one-topic}
graph_single_topic_subgraph %>% 
  filter(topic == 235) %>% 
  mutate(
    vs = vvcount(topic_graph) - 1,
    es = vecount(topic_graph)
  ) %>% 
  ggplot(mapping = aes(x = date, y = value, colour = variable)) +
  geom_line(mapping = aes(y = vs, colour = "vertices")) +
  geom_line(mapping = aes(y = es, colour = "edges")) +
  scale_x_date(
    date_breaks = "1 year",
    date_minor_breaks = "3 month",
    date_labels = "%Y"
  ) +
  theme(
    axis.text.x = element_text(angle = 90)
  ) +
  labs(
    x = "Zeit",
    y = "Anzahl"
  ) +
  scale_color_discrete(name = "Variable", labels = c("vertices" = "Knoten", "edges" = "Kanten")) +
  facet_wrap(~topic)
```

Auch in der Verteilung der Kanten und Knoten der Teilgraphen können wir kein unmittelbares Indiz für ein Verlassen des Topics 239 erkennen; in den Monaten unmittelbar vor dem Verlassen weist der Interaktionsgraph von Topic 239 für vergleichsweise wenige Knoten eine hohe Kantenzahl auf. Unter Umständen gibt eine Analyse der Beiträge auf inhaltlicher Ebene Aufschluss über die Qualität der Interaktionen.

Für jeden dieser Teilgraphen können wir wiederum die Reziprozität messen. Wie bereits zuvor wählen wir als Maß den
Katz-Powell Index.

```{r monocasa-subgraph-reciprocity}
kpdata <- graph_single_topic_subgraph %>%
  mutate(kp = katz_powell_mutuality(topic_graph))

ggplot(data = na.omit(kpdata), mapping = aes(x = date, y = kp, colour = topic)) +
  geom_line() +
  geom_point(size = .4) +
  scale_x_date(
    date_breaks = "1 year",
    date_minor_breaks = "3 month",
    date_labels = "%Y"
  ) +
  theme(axis.text.x = element_text(angle = 90)) +
  labs(
    x = "Zeit",
    y = "Katz-Powell-Index"
  ) +
  scale_colour_discrete(name = "Topic") +
  facet_wrap( ~ topic)


ggplot(data = na.omit(kpdata), mapping = aes(x = kp, y = prop_alters*prop_ego, colour = topic)) +
  geom_smooth() +
  geom_point(size = .4) +
  facet_wrap(~topic)

```
Bis auf 235 weisen alle Topics im Oktober 2013 ein Loch auf, was auf einen leeren Graphen zurückzuführen ist. Im Fall von Topic 
235 enthält der Graph zwar Kanten, jedoch zu wenig, um ein sinnvolles Indexmaß berechnen zu können.

```{r monocasa-weighted-degree}
graph_single_topic_subgraph %>%
  mutate(
    topic_graph_degree_ratio = map_dbl(topic_graph, degree_ratio_wrapper),
    ego_weighted_degree = topic_graph_degree_ratio * prop_ego,
    alters_weighted_degree = topic_graph_degree_ratio * prop_alters,
    ) %>%
  select(-num_posts,
         -graph) %>% 
  ggplot(mapping = aes(x = date, y = ego_weighted_degree, colour = topic)) +
  geom_line() +
  theme(axis.text.x = element_text(angle = 90), legend.position = "bottom") +
  facet_wrap(~topic)
```

```{r monocasa-degree-distribution}
graph_single_topic_subgraph %>%
  mutate(
    in_degree = vdegree(topic_graph, v = user, mode = c("in")),
    out_degree = vdegree(topic_graph, v = user, mode = c("out"))
  ) %>%
  ggplot(mapping = aes(x = date, y = degree, colour = degree)) +
  geom_line(mapping = aes(y = in_degree, colour = "in")) +
  geom_line(mapping = aes(y = out_degree, colour = "out")) +
  labs(x = "Zeit", y = "Wert") +
  scale_colour_discrete(name = "Knoten-Grad", labels = c("in" = "Ein", "out" = "Aus")) +
  theme(axis.text.x = element_text(angle = 90), legend.position = "bottom") +
  facet_wrap(~ topic)
```




Offensichtlich stoßen wir bei dieser Untersuchung an die Grenzen der Computational Social Science. Wir können nur
diejenigen Effekte versuchen zu erklären, die wir anhand der vorliegenden Daten beobachten können. Es ist durchaus
denkbar, dass eine reduzierte Aktivität nicht anhand intrinsicher Messungen erklärt werden kann, sondern dass externe 
Faktoren dafür verantwortlich sind. Ein geeignetes Mittel, um diese Beobachtungen verstehen zu können, wäre etwa der
in den Sozialwissenschaften häufig gebrauchte Fragebogen, oder das Interview. 
