### formido
Der Nutzer mit dem Namen "formido" ist im betrachteten Ausschnitt aus dem Datensatz in 119 Monaten enthalten und hat insgesamt 7996 Kommentare erstellt, was im Mittel `r fmt(round(7996 / 119, 2))` Kommentaren pro Monat entspricht.

```{r formido-setup, cache=FALSE}
user <- "formido"
date_range_full_start <- "2007-01-01"
date_range_full_end <- "2018-02-01"
date_range_cut_start <- "2011-10-01"
date_range_cut_end <- "2015-10-01"

date_range_full <-
    seq.Date(as.Date(date_range_full_start),
             as.Date(date_range_full_end),
             by = "1 month")

date_range <-
  seq.Date(from = as.Date(date_range_cut_start),
           to = as.Date(date_range_cut_end),
           by = "1 month")

ego_topics_full <-
  read_ego_topics(user = user, date = date_range_full)
alters_topics_full <-
  read_alters_topics(user = user, date = date_range_full)

ego_proportions_full <- post_proportions(ego_topics_full)
alters_proportions_full <- user_proportions(alters_topics_full)


ego_topics <- read_ego_topics(user = user, date = date_range)
ego_proportions <- post_proportions(ego_topics)

alters_topics <- read_alters_topics(user = user, date = date_range)
alters_proportions <- user_proportions(alters_topics)

topics_present <-
  union(ego_proportions_full$topic, alters_proportions_full$topic)
cols <- fill_colours(topics_present)

edgelists <-
  read_edgelist(user, date = date_range) %>%
  select(-year, -month, edgelist = data)

topics_of_alters <-
  read_alters_topics(user, date = date_range) %>%
  select(-year, -month, topics = data)

df <-
  left_join(ego_proportions,
            alters_proportions,
            by = c("date", "topic")) %>%
  rename(prop_ego = prop.x, prop_alters = prop.y)
```

#### Topic-Verteilungen

Um einen Überblick zu erhalten, in welchen Topics der Nutzer aktiv ist, bietet es sich an, die Verteilung der Kommentare zu visualisieren.
Alle Kommentare werden über das Subreddit, in dem sie erstellt wurden, einem Topic zugeordnet.
In Abbildung \@ref(fig:formido-topic-distribution) ist zu erkennen, dass der Nutzer hauptsächlich in drei Topics aktiv ist: 210, 239 und 235.
Auch der zeitliche Verlauf der Topics in Abbildung \@ref(fig:formido-area-chart-comms-full) lässt dies erkennen.
Wie bereits weiter oben festgestellt, handelt es sich bei Topic 239 um technisch orientierte Inhalte, bei 210 um Politik mit Schwerpunkt auf US-amerikanischen Themen.
Die weitere Analyse wird sich vor allem auf diese großen Topics stützen, da sie zum einen trennscharf abgegrenzt werden können, und zudem die meiste Aktivität des Nutzers auf sich vereinen.

(ref:formido-topic-distribution) Verteilung von Kommentaren über Topics.
```{r formido-topic-distribution, fig.cap="formido-topic-distribution",cache=FALSE}
comment_dist_boxplot(ego_proportions_full)
```

Bei der Analyse des Topic-Verlaufs fällt auf, dass der Anteil von Topic 239 zwischen 2013 und 2014 zweimal stark abfällt: einmal im Juli 2013 und kurz darauf im Oktober 2013.
Der Abfall auf einen Anteil von 0 eines Topics wird im weiteren Verlauf gleichgesetzt mit einem Verlassen dieser thematischen Community durch den Nutzer.
Im Folgenden wird der Frage nachgegangen, was für dieses Verlassen ursächlich sein könnte.
Dazu werden verschiedene Eigenschaften der Topicverläufe sowie der lokalen Egonetzwerke des Nutzers herangezogen.
Der Untersuchungszeitraum wird auf die Zeit zwei Jahre vor und zwei Jahre nach dem Verlassen im Oktober 2013 festgelegt; dies ist durch die beiden gepunkteten Linien sowie die grau hinterlegte Fläche in Abb.\ \@ref(fig:formido-topic-distribution) angedeutet.

Auch für die Alteri lässt sich ein ähnlicher Topic-Verlauf bestimmen, indem pro Monat für jeden von ihnen das Topic bestimmt wird, wo er die meisten Kommentare verfasst; so wird jeder dieser Nutzer auf ein einzelnes Topic festgelegt, das ihn charakterisiert.
Damit lässt sich bestimmen, welchen Anteil ein Topic unter den Alteri ausmacht.
Auch Abbildung \@ref(fig:formido-area-chart-alters-full) lässt erkennen, dass in dem gewählten Zeitraum der Anteil der Alteri, die sich ebenfalls an diesem Topic beteiligen, auf 0 abfällt.
Zudem fällt auf, dass sich Ego und Alteri durchaus in ihren Interessen überschneiden; in `r pronounce(length(intersect(ego_proportions_full$topic, alters_proportions_full$topic)))` Topics erstellen sowohl Ego als auch Alteri Kommentare.

(ref:formido-area-chart-comms-full) Topic-Verteilung von Egos Kommentaren. Dargestellt sind die relativen Anteile eines Topics an allen Kommentaren, die Ego in einem gegebenen Monat erstellt.
```{r formido-area-chart-comms-full, fig.cap="(ref:formido-area-chart-comms-full)"}
area_plot_posts(ego_proportions_full, date_range_cut_start, date_range_cut_end)
```
(ref:formido-area-chart-alters-full) Topic-Verteilung der Alteri im lokalen Netzwerk. Dargestellt sind die relativen Anteile eines Topics an allen Kommentaren, die Ego in einem gegebenen Monat erstellt.
```{r formido-area-chart-alters-full, fig.cap="(ref:formido-area-chart-alters-full)"}
area_plot_alters(alters_proportions_full, date_range_cut_start, date_range_cut_end)
```

(ref:formido-num-posts) Kommentare pro Monat pro Topic. Die gepunktete Linie zeigt das Datum des "Verlassens" von Topic 239.
```{r formido-num-posts, fig.cap="(ref:formido-num-posts)", include=TRUE}
num_posts_facet(ego_proportions) + geom_vline(aes(xintercept = as.Date("2013-10-01")), linetype = "dotted")
```

#### Zusammenhang zwischen Ego und Alteri

Zunächst soll betrachtet werden, wie das Kommentar-Verhalten von Ego mit der Zusammensetzung seiner Alteri zusammenhängt.
Die Vermutung dabei ist, dass ein höherer Anteil Alteri eines Topics dazu führt, dass auch Ego vermehrt in diesem Topic aktiv ist, bzw. Ego, basierend auf seinen Interessen, sein Umfeld auswählt.

(ref:formido-prob-corr) Die beiden Anteile an Topic-Zugehörigkeit, gegeneinander aufgetragen. Entlang der x-Achse ist der relative Anteil an Kommentaren angetragen, die Ego in einem Topic verfasst hat; entlang der y-Achse ist der relative Anteil Alteri angetragen, der einem Topic zugeordnet wurde. Die blaue Linie fittet ein lineares Modell auf den Daten.
```{r formido-prob-corr, fig.cap = "(ref:formido-prob-corr)"}
left_join(ego_proportions_full, alters_proportions_full, by = c("date", "topic")) %>%
  rename(prop_ego = prop.x, prop_alters = prop.y) %>%
  filter(date >= date_range_cut_start & date <= date_range_cut_end) %>% 
  ggplot(mapping = aes(x = prop_ego, y = prop_alters, colour = topic)) +
  geom_point(alpha = 0.5) +
  geom_smooth(method = "lm", size = .8) +
  geom_abline(size = .1) +
  labs(
    x = "Anteil Kommentare",
    y = "Anteil Alteri"
  ) +
  scale_colour_manual("topic",
                      values = cols) +
  facet_wrap(~ topic) +
  theme(
    axis.text.x = element_text(angle = 0),
    legend.position = "none"
  )
```

Wie vermutet lassen sich vor allem bei den großen Topics, in denen der Nutzer vermehrt Aktivität verzeichnet, lineare Zusammenhänge erkennen.
Auffällig dabei ist, dass die beiden Topics 210 und 239 sub-linear wachsen, ihre Regressionsgerade also unterhalb der Diagonal verläuft.
Der Nutzer ist also verstärkt in diesen Topics aktiv, obwohl sein Umfeld nicht "mitzieht".

#### Anziehungskraft von Topics

Was macht ein Topic attraktiv für einen Nutzer?
Zum Einen sollte es ihn selbst interessieren, zum anderen sollte aber auch sein Umfeld dieses Thema kennen und sich ihm widmen.
Fasst man die erhobenen Topic-Verteilungen von Ego und Alteri als Wahrscheinlichkeiten auf, dass Ego einen Kommentar in einem Topic abgibt resp. dass einer der Alteri in diesem Topic aktiv ist, kann man auch Attraktivität als Wahrscheinlichkeit definieren, dass ein Nutzer in einem Topic verbleibt.
Diese ist umso höher, je höher die beiden anderen Wahrscheinlichkeiten sind, weshalb im Folgenden Attraktivität als gemeinsame Wahrscheinlichkeit der Ereignisse $E = \{\text{Ego erstellt Kommentar in Topic}\}$ und $A = \{\text{Alter ist in Topic aktiv}\}$ aufgefasst wird:

\begin{equation}
P(E \cap A) = P(E)P(A)
(\#eq:attractive)
\end{equation}

(ref:formido-interestingness) Attraktivität angetragen über den zeitlichen Verlauf. Die gepunktete Linie kennzeichnet den Zeitpunkt des Verlassens von Topic 239. In dieser Darstellung enthalten sind alle Topics, deren Attraktivität in Summer echt größer 0 ist.
```{r formido-interestingness, fig.cpa="(ref:formido-interestingness)"}
attractivity(ego_proportions_full, alters_proportions_full, date_range_cut_end, date_range_cut_start) +
  geom_vline(aes(xintercept = as.Date("2013-10-01")), linetype = "dotted")
```

$P(E \cap A)$ wird nachfolgend auch als *Attraktivität* wiedergegeben.
Abbildung \@ref(fig:formido-interestingness) zeigt die zeitliche Entwicklung dieser Messgröße.
Es sind einige Spitzen zu erkennen, die auf sehr hohe, aber zeitlich begrenzte Attraktivität hindeuten.
Der Zeitpunkt des Austritts aus 239 liegt inmitten einer Phase niedriger Attraktivität dieses Topics.

Um die spitzen Ausschläge besser verstehen zu können, bietet es sich an, die Gesamtzahl aller Kommentare zu betrachten.
Ist der Nutzer allgemein zu einem beliebigen Zeitpunkt eher weniger aktiv und erstellt einen einzelnen Kommentar, wird dieser einen solchen Ausschlag herbeiführen.
Abbildung\ \@ref(fig:formido-total-posts) zeigt den zeitlichen Verlauf erstellter Kommentare je Topic, sowie deren Summe.
Der Knick zum Zeitpunkt, als der Nutzer Topic 239 verlässt, deutet darauf hin, dass hier eine Phase allgemein geringer Aktivität vorliegt.

(ref:formido-total-posts) Anzahl Kommentare je Topic über die Zeit aufgetragen, sowie die Summe aller Kommentare als rot gestrichelte Linie.
```{r formido-total-posts, fig.cap="(ref:formido-total-posts)"}
 
total_posts(ego_proportions, date_range_cut_end, date_range_cut_start) +
 geom_vline(mapping = aes(xintercept = as.Date("2013-10-01")), linetype = "dotted") +
 scale_colour_manual("Topic",
                    values = cols,
                    guide = guide_legend(
                      direction = "horizontal",
                      title.position = "top",
                      label.position = "bottom",
                      nrow = 1
                    ))
  
```

#### Analyse des Netzwerks

```{r formido-egonets}

# identify the single top topic of ego for a month in the dataset
ego_top_topics <-
  ego_proportions %>%
  group_by(date) %>%
  summarize(user = user,
            topic = topic[which.max(prop)]) %>%
  select(date, user = user, topic)

vertex_data <-
  topics_of_alters %>%
  unnest() %>%
  select(date, user = author1, topic) %>%
  rbind(ego_top_topics) %>%
  group_by(date) %>%
  nest() %>%
  rename(topics = data)

graph_data <-
  left_join(edgelists, vertex_data, by = "date") %>%
  mutate(graph = map2(edgelist, topics, egonet_from_edgelist)) %>%
  select(date, graph)
```

In den vorangegangenen Abschnitten wurde die Themenhistorie der Nutzer betrachtet.
Im Folgenden wird nun der Blick auf das persönliche soziale Netzwerk des Nutzers gerichtet.
Um einen ersten Eindruck von der Größe und Struktur der Kommunikationsbeziehungen des Nutzers zu erhalten, zeigt Abbildung \@ref(fig:formido-network-structure) die Anzahl der Knoten und Kanten im sozialen Graph des Nutzers, *über den gesamten Beobachtungszeitraum*.
Das Wachstum des Graphen ist hier gut zu Erkennen, ebenso der Zeitpunkt sehr geringer Aktivität im Oktober 2013.
Knoten und Kanten wachsen in etwa gleich stark an, woraus sich schließen lässt, dass der Nutzer die Anzahl seiner Kontakte ausbaut.

(ref:formido-network-structure) Zahl der Knoten sowie Kanten des lokalen sozialen Netzwerks, angetragen über die Zeit. Wie zuvor auch kennzeichnet die gepunktete Linie den Austritt aus Topic 239.
```{r formido-network-structure, fig.cap="(ref:formido-network-structure)"}
graph_data %>%
  ggplot(mapping = aes(x = date, y = count, colour = variable)) +
  geom_line(mapping = aes(y = vvcount(graph), colour = "Knoten")) +
  geom_smooth(mapping = aes(y = vvcount(graph), colour = "Knoten"), size = .25) +
  geom_line(mapping = aes(y = vecount(graph), colour = "Kanten")) +
  geom_smooth(mapping = aes(y = vecount(graph), colour = "Kanten"), size = .25) +
  scale_x_date(
    date_breaks = "1 year",
    date_minor_breaks = "3 month",
    date_labels = "%Y"
  ) +
  theme(
    axis.text.x = element_text(angle = 0), legend.position = "bottom"
  ) + 
  labs(
    x = "",
    y = "Anzahl"
  ) +
  scale_colour_discrete(name = "Variable") +
  geom_vline(mapping = aes(xintercept = as.Date("2013-10-01")), linetype = "dotted")
```

#### Reziprozität
Wie bereits in früheren Kapiteln erwähnt gibt ein Maß für Reziprozität Auskunft darüber, ob Kanten zwischen Knoten wechselseitig oder asymmetrisch angelegt sind.
Als Maß für Reziprozität in sozialen Netzwerken wählt diese Arbeit den Katz-Powell-Index (im Verlauf auch $\rho_{KP}$).
Mit diesem Maß lässt sich feststellen, wie interaktiv ein sozialer Graph ist.
Werden Kanten tendenziell erwidert kann man in diesem Kontext von einer "Unterhaltungskultur" sprechen.

(ref:formido-katz-powell) Katz-Powell-Index $\rho_{KP}$ angetragen über die gesamte Zeit.
```{r formido-katz-powell, fig.caption="(ref:formido-katz-powell)"}

graph_data %>%
  mutate(
    katz_powell = katz_powell_mutuality(graph),
    ratio_reciprocity = map_dbl(graph, reciprocity, mode = "ratio")
  ) %>%
  ggplot(mapping = aes(x = date, y = katz_powell)) +
  geom_line() +
  geom_smooth() +
  scale_y_continuous(limits = c(0, NA) ) +
  scale_x_date(
    date_breaks = "1 year",
    date_minor_breaks = "3 month",
    date_labels = "%Y"
  ) +
  theme(
    axis.text.x = element_text(angle = 0), legend.position = "bottom"
  ) +
  labs(x = "", y = expression(rho["KP"])) +
  geom_vline(mapping = aes(xintercept = as.Date("2013-10-01")), linetype = "dotted")
```

Der Index $\rho_{KP}$ bewegt sich zwischen 0 und 1, bzw. nimmt negative Werte an, falls eine Tendenz hin zu asymmetrischen Beziehungen besteht.
Wie Abbildung \@ref(fig:formido-katz-powell) jedoch zeigt, steigt der Indexwert zu Beginn langsam an und erreicht dann im ersten Drittel sein vorläufiges Maximum.
Der allgemein eher hohe Wert zwischen 0.4 und 0.5 deutet darauf hin, dass in diesem Graphen Kanten erwidert werden.
Zu beachten ist jedoch das Loch im Oktober 2013; dies ist dadurch zu erklären, dass der Graph zu diesem Zeitpunkt neben Ego keine weiteren Knoten enthält, der Nutzer also keine Interaktionen pflegt.
Solche Löcher werden in der ursprünglichen Definition von Katz und Powell [@Katz1955] nicht erwähnt und stellen ein Detail der Implementierung dar, um auch Spezialfälle sinnvoll im Diagramm festzuhalten.

#### Thematische Teilgraphen

Der gesamte Snapshot-Graph $G$ des Nutzers umfasst alle Interaktionen, die in einem Monat stattfinden.
Kanten manifestieren sich von Ego zu Alteri wenn der eine auf einen Kommentar des anderen reagiert.
Für Ego ist bekannt, in welchen fünf Topics er in einem Monat am meisten Kommentare erstellt hat, für Alteri ist jeweils ein Topic bekannt.
Sei nun $G'$ der Teilgraph, der entsteht, wenn man alle Kanten zu Alteri entfernt, die kein Topic mit Ego gemeinsam haben.
Umgekehrt kann man fordern, dass Ego nur Kanten zu Alteri ausbildet, mit denen er ein Thema gemeinsam hat.
Den resultierenden Teilgraph kennzeichnet die thematische Affinität von Ego und Alteri.

In Abbildung \@ref(fig:formido-topical-subgraph) ist für jeden der beiden Graphen $G$ und $G'$ die Zahl der Knoten $|G|$ und $|G'|$ sowie deren Differenz $|G|- |G'|$ im zeitlichen Verlauf angetragen; $|G|$ wird auch als *Ordnung* des Graphen bezeichnet.
Die Differenz der beiden Ordnungen bezeichnet im Wesentlichen die menge der Knoten, die kein thematisches Interesse mit Ego teilen.
Diese Größe wird 0, wenn alle Knoten des gesamten Graphen auch im Teilgraphen enthalten sind, die "thematische Überdeckung" von Ego und Alteri also maximal ist.
Die Abbildung zeigt, dass die Differenz nahe 0 einsetzt, im Verlauf der Zeit jedoch zunimmt, wenn auch langsamer als die beiden Ordnungen.
Daraus lässt sich schließen, dass der Nutzer wohl zugleich mit einer Ausweitung seiner Interaktionen diese auch diversifiziert.

(ref:formido-topical-subgraph) Ordnung des gesamten Graphen $G$ und des thematischen Teilgraphen $G'$,sowie deren Differenz $|G| - |G|'$. Die angetragenen Regressionsgeraden verdeutlichen das unterschiedliche Wachstum der Größen.
```{r formido-topical-subgraph, fig.cap="(ref:formido-topical-subgraph)"}
# TODO: Filter topical subgraphs, then compute weighted degree

graph_topical_subgraph <-
  graph_data %>%
  left_join(ego_topics, by = c("date")) %>%
  mutate(topical_subgraph = map2(graph, data, function(graph, df) {
    filter_graph(graph, unique(df$topic))
  }))

graph_topical_subgraph %>%
  mutate(size_diff = vvcount(graph) - vvcount(topical_subgraph)) %>%
  ggplot(mapping = aes(x = date, y = nodes, colour = graph)) +
  geom_line(mapping = aes(y = vvcount(graph), colour = "G")) +
  geom_line(mapping = aes(y = vvcount(topical_subgraph), colour = "G'")) +
  geom_line(mapping = aes(y = size_diff, colour = "G - G'")) +
  geom_smooth(method = "lm", se = FALSE, size = .3, mapping = aes(y = size_diff, colour = "G - G'")) +
  geom_smooth(method = "lm", se = FALSE, size = .3, mapping = aes(y = vvcount(graph), colour = "G")) +
  geom_smooth(method = "lm", se = FALSE, size = .3, mapping = aes(y = vvcount(topical_subgraph), colour = "G'")) +
  scale_x_date(
    date_breaks = "1 year",
    date_minor_breaks = "3 month",
    date_labels = "%Y"
  ) +
  theme(
    axis.text.x = element_text(angle = 90), legend.position = "bottom"
  )
```

#### Reziprozitäten im Teilgraph

Neben der Ordnung lässt sich auch die Reziprozität des thematischen Teilgraphen bestimmen.
Erneut wird dazu der Index von Katz und Powell herangezogen.
Die Konstruktion des Teilgraphen erfolgt ähnlich wie im vorherigen Abschnitt, allerdings mit der Einschränkung, dass für Ego ein einziges Topic mit maximaler Aktivität ausgewählt wird.
Nach dieser Konstruktion haben im thematischen Teilgraph sowohl Ego als auch Alteri dasselbe Topic zugewiesen; stellt man sich die Topic-Affinität als Farbe vor, hat der Graph im vorhergehenden Abschnitt fünf Farben, hier ist er jedoch einfarbig.
Zwar wechselt das Ego-Topic mit hoher Wahrscheinlichkeit von Monat zu Monat; dies stellt jedoch keine Einschränkung dar.
Dadurch kann die Frage beantwortet werden, ob Nutzer dazu neigen, zu Gleichgesinnten eher symmetrische Beziehungen aufzubauen.
Es sei darauf hingewiesen, dass dieser Ansatz nicht nur Aussagen über Ego zulässt, sondern auch über die Alteri, da der Index $\rho_{KP}$ stets das ganze Netzwerk in Betracht zieht.

Die Vermutung liegt nahe, dass Kanten zu Gleichgesinnten eher wechselseitig ausgeprägt sind als Kanten zu Nutzern, mit denen man keine Interessen teilt.
Um dies zu prüfen, werden für den gesamten Graph $G$ und den "mono-thematischen" Teilgraph $G'$ die Indexe berechnet, sowie die Differenz beiden Maße, $\rho_{kp}(G')-\rho_{KP}(G)$.
Diese wird umgekehrt zu der im vorherigen Abschnitt gebildet, da vermutet wird, dass der thematische Teilgraph höhere Indexwerte aufweist als der Gesamtgraph, und die Differenz damit positiv bleibt, was bei der Interpretation hilft.
Abbildung \@ref(fig:formido-topical-subgraph-reciprocity) bestätigt die Vermutung in Teilen.
Der Index nimmt für den Teilgraphen tatsächlich häufig höhere Werte an, dieser tendiert also eher zu wechselseitigen Kanten; allerdings kehrt sich der Index auch ins Negative und oszilliert um die 0.

(ref:formido-topical-subgraph-reciprocity) Index von Katz und Powell für den monothematischen Teilgraphen der entsteht, wenn man Ego und Alteri auf ihr aktivstes Topic reduziert und nur Kanten zwischen Nutzern mit gleichen Topics zulässt. Ebenfalls dargestellt ist die Differenz der beiden Größen, die 0 wird, wenn beide Graphen gleich reziprok sind, gegen -1 geht wenn der Gesamtgraph eher wechselseitig und gegen +1 wenn der Teilgraph eher symmetrisch angelegt ist.
```{r formido-topical-subgraph-reciprocity, fig.cap="(ref:formido-topical-subgraph-reciprocity)"}

graph_topical_subgraph <-
  graph_data %>% 
  left_join(ego_top_topics, by = c("date")) %>%
  mutate(topical_subgraph = map2(graph, topic, function(graph, t) {
    filter_graph(graph, t)
  }))

graph_topical_subgraph %>%
  mutate(kp_full = katz_powell_mutuality(graph), kp_topical = katz_powell_mutuality(topical_subgraph)) %>%
  ggplot(mapping = aes(x = date, y = nodes, colour = graph)) +
  geom_line(mapping = aes(y = kp_full, colour = "G")) +
  geom_line(mapping = aes(y = kp_topical, colour = "G'")) +
  geom_line(mapping = aes(y = kp_topical - kp_full, colour = "G - G'")) + 
  geom_smooth(mapping = aes(y = kp_topical - kp_full, colour = "G'- G")) +
  scale_x_date(
    date_breaks = "1 year",
    date_minor_breaks = "3 month",
    date_labels = "%Y"
  ) +
  theme(
    axis.text.x = element_text(angle = 90), legend.position = "bottom"
  )
```

#### Größe der Teilgraphen

Die abschließende Betrachtung gilt der Anzahl an Knoten und Kanten in den jeweiligen Teilgraphen.
Mittels der Zahl der Knoten kann festgestellt werden, mit wie vielen Alteri der Nutzer kommuniziert, die Zahl der Kanten gibt Aufschluss darüber, wie viele Interaktionen stattfinden.

Abbildung \@ref(fig:formido-subgraph-per-topic) zeigt diese beiden Maße für jedes Topic, in Abbildung \@ref(fig:formido-subgraph-one-topic) wird speziell Topic 239 in den Fokus gerückt.


```{r formido-single-topic-subgraph}

graph_single_topic_subgraph <-
  ego_proportions %>%
  rename("prop_ego" = prop) %>% 
  left_join(graph_data, by = "date") %>%
  left_join(alters_proportions, by = c("date", "topic")) %>% 
  rename("prop_alters" = prop) %>% 
  mutate(
    topic_graph = map2(graph, topic, filter_graph_wrapper)
    )
```

(ref:formido-subgraph-per-topic) Verteilung der Knoten und Kanten in den thematischen Teilgraphen.
```{r formido-subgraph-per-topic, fig.cap="(ref:formido-subgraph-per-topic)"}
graph_single_topic_subgraph %>% 
  mutate(
    vs = vvcount(topic_graph) - 1,
    es = vecount(topic_graph)
  ) %>% 
  ggplot(mapping = aes(x = date, y = value, colour = variable)) +
  geom_line(mapping = aes(y = vs, colour = "vertices")) +
  geom_line(mapping = aes(y = es, colour = "edges")) +
  scale_x_date(
    date_breaks = "1 year",
    date_minor_breaks = "3 month",
    date_labels = "%Y"
  ) +
  theme(
    axis.text.x = element_text(angle = 90)
  ) +
  labs(
    x = "",
    y = "Anzahl"
  ) +
  scale_color_discrete(name = "Variable", labels = c("vertices" = "Knoten", "edges" = "Kanten")) +
  facet_wrap(~topic)
```

(ref:formido-subgraph-one-topic) Verteilung der Knoten und Kanten im thematischen Teilgraphen von Topic 239.
```{r formido-subgraph-one-topic, fig.cap="(ref:formido-subgraph-one-topic)"}
graph_single_topic_subgraph %>% 
  filter(topic == 239) %>% 
  mutate(
    vs = vvcount(topic_graph) - 1,
    es = vecount(topic_graph)
  ) %>% 
  ggplot(mapping = aes(x = date, y = value, colour = variable)) +
  geom_line(mapping = aes(y = vs, colour = "vertices")) +
  geom_line(mapping = aes(y = es, colour = "edges")) +
  scale_x_date(
    date_breaks = "1 year",
    date_minor_breaks = "3 month",
    date_labels = "%Y"
  ) +
  theme(
    axis.text.x = element_text(angle = 90)
  ) +
  labs(
    x = "",
    y = "Anzahl"
  ) +
  scale_color_discrete(name = "Variable", labels = c("vertices" = "Knoten", "edges" = "Kanten")) + 
  geom_vline(mapping = aes(xintercept = as.Date("2013-10-01")), linetype = "dotted") +
  facet_wrap(~topic)
```

Die Verteilung der Kanten in Abbildung \@ref(fig:formido-subgraph-one-topic) weist in den Monaten vor dem Verlassen im Oktober 2013 vergleichsweise viele Kanten zu wenigen Knoten auf.
Hier könnte ein Indiz für den "Bruch"mit diesem Topic liegen, zumal sich diese Beobachtung im Juni 2014 wiederholt.
So ist es denkbar, dass der Nutzer einen regen Austausch mit wenigen Einzelpersonen erlebt hat, der ihn dazu veranlasst hat, dieses Topic in der Folge zu meiden.
Ebenso denkbar ist es aber auch, dass externe Gründe aus der physischen Welt dafür verantwortlich sind, etwa ein Urlaub oder ein Umzug.
Klar ist, dass an dieser Stelle keine definitive Antwort gegeben werden kann, und dass weitere Methoden herangezogen werden müssen, um diese Frage zu klären.


```{r formido-subgraph-reciprocity}
kpdata <- graph_single_topic_subgraph %>%
  filter(topic == 239) %>% 
  mutate(kp = katz_powell_mutuality(topic_graph))

ggplot(data = na.omit(kpdata), mapping = aes(x = date, y = kp, colour = topic)) +
  geom_line() +
  geom_point(size = .4) +
  scale_x_date(
    date_breaks = "1 year",
    date_minor_breaks = "3 month",
    date_labels = "%Y"
  ) +
  theme(axis.text.x = element_text(angle = 90)) +
  labs(
    x = "Zeit",
    y = "Katz-Powell-Index"
  ) +
  scale_colour_discrete(name = "Topic") +
  facet_wrap( ~ topic)
```
